{"version":3,"sources":["webpack:///./src/app/view-resturant-modal/view-resturant-modal.page.html","webpack:///./src/app/view-resturant-modal/view-resturant-modal.page.scss","webpack:///./src/app/view-resturant-modal/view-resturant-modal.page.ts"],"names":[],"mappings":"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","file":"default~cust-cart-cust-cart-module~dashboard-cust-dashboard-cust-module.js","sourcesContent":["module.exports = \"<ion-header>\\n  <ion-toolbar>\\n    <ion-title>{{ resturant.resturantName }}</ion-title>\\n    <div text-right>\\n        <ion-button color = \\\"danger\\\" (click)=\\\"dismiss()\\\">X</ion-button>\\n      </div>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content padding>\\n  <div *ngFor = \\\"let mi of menItems\\\">\\n    <ion-card>\\n        <ion-card-header>\\n            <ion-card-title>{{ mi.item_name }}</ion-card-title>\\n          </ion-card-header>\\n        \\n          <ion-card-content>\\n            Price: {{mi.item_price}}\\n            <br>\\n            Description: {{mi.item_description}}\\n            <br>\\n            <ion-button (click)=\\\"addToCart(mi)\\\" size = \\\"small\\\">Add To Cart</ion-button>\\n          </ion-card-content>\\n        </ion-card>\\n      \\n  </div>\\n\\n</ion-content>\\n\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3ZpZXctcmVzdHVyYW50LW1vZGFsL3ZpZXctcmVzdHVyYW50LW1vZGFsLnBhZ2Uuc2NzcyJ9 */\"","import { Component, OnInit } from '@angular/core';\nimport { ModalController, NavParams, AlertController, ToastController } from '@ionic/angular';\nimport { ResturantService } from '../resturant.service';\nimport * as firebase from 'firebase/app'; // required for app->firestore communication\nimport 'firebase/firestore';\nimport { AngularFirestore } from '@angular/fire/firestore';\nimport { CartService } from '../cart.service';\nimport { UserService } from '../user.service';\nimport { query } from '@angular/core/src/render3';\nimport { async } from 'q';\nimport { connectableObservableDescriptor } from 'rxjs/internal/observable/ConnectableObservable';\n\n@Component({\n  selector: 'app-view-resturant-modal',\n  templateUrl: './view-resturant-modal.page.html',\n  styleUrls: ['./view-resturant-modal.page.scss'],\n})\nexport class ViewResturantModalPage implements OnInit {\n  resturant\n  rid: string = \"\"\n  status: number = 0\n  uid: string = \"\"\n  existResOpenCart\n  \n  existItem\n  updatedQty: number;\n  \n  constructor(\n    public modalController: ModalController, \n    public navParams: NavParams,\n    private resSer: ResturantService,\n    private afs: AngularFirestore,\n    private cart: CartService,\n    private user: UserService,\n    private toast: ToastController\n    ) { \n    this.resturant = this.navParams.get('rs')\n    console.log(this.resturant)\n  }\n  menItems = [];\n  async ngOnInit() {\n    let s2 = this.resSer.getMenuSubcollection(this.resturant.res_id, this.menItems).subscribe(menuItems=>\n      {\n        this.menItems=menuItems;\n        console.log(this.menItems);\n      });\n  }\n  dismiss(){\n    this.modalController.dismiss();\n\n  }\n  async addToCart(mi){\n    let db = firebase.firestore();\n    console.log(mi.item_id);\n    this.user.getCurrentUID().subscribe(async uid=>\n      {\n        this.uid = uid;\n            var query1 = db.collection('cart').where('res_id', '==', this.resturant.res_id).where('user_id', '==', this.uid).where('status', '==', 0);\n            \n            const snapshot1 = await query1.get();\n            if(!snapshot1.empty){\n              //adding to existing cart\n                  console.log(\"in if statement\");\n                  //let itemId = this.afs.createId()\n                  \n                  this.cart.getCurCartforRes(this.uid, this.resturant.res_id, this.existResOpenCart).subscribe(async cart=>\n                    {\n                     this.existResOpenCart = cart;\n                      console.log(this.existResOpenCart.cart_id);\n                      var query2 = db.collection('cart').doc(this.existResOpenCart.cart_id).collection('items').where('item_id', '==', mi.item_id);\n                      const snapshot2 = await query2.get();\n                      if(!snapshot2.empty){\n                        console.log(\"in snapsot not empty\");\n                        console.log(this.existResOpenCart.cart_id);\n                        \n                          this.cart.getSingleItem(this.existResOpenCart.cart_id, mi.item_id).then(async item=>{\n                            //console.log(item);\n                            console.log(this.existItem);\n                            this.existItem=item;\n                            //this.updatedQty= item.item_qty + 1;\n                            console.log(this.updatedQty);\n                            try{\n                                /**/\n                                db.collection('cart').doc(this.existResOpenCart.cart_id).collection('items').doc(mi.item_id).update({\n                                  item_qty: (this.existItem.item_qty+1)\n                                });\n                                const toast = await this.toast.create({\n                                  message: 'Item added to existing cart',\n                                  duration: 1000,\n                                  position: 'top'\n                                });\n                                return await toast.present();\n                              }\n                              catch{\n                                console.log(\"error\");\n                              }\n                          })\n                      }\n                      else{\n                          try{\n                            db.collection('cart').doc(this.existResOpenCart.cart_id).collection('items').doc(mi.item_id).set({\n                              item_name: mi.item_name,\n                              item_price: mi.item_price,\n                              item_description: mi.item_description,\n                              item_id: mi.item_id,\n                              item_qty: 1\n                            })\n                            const toast = await this.toast.create({\n                              message: 'Item added to existing cart',\n                              duration: 1000,\n                              position: 'top'\n                            });\n                            return await toast.present();\n                          }\n                          catch{\n                            console.log(\"There has been an error\");\n                          }\n                      }\n                    })\n                }\n              else{\n                //making a new cart\n                console.log(\"in else statement\");\n                    let id = this.afs.createId();\n                    //let itemId = this.afs.createId();\n                    try{\n                          db.collection('cart').doc(id).set({\n                            user_id: this.uid,\n                            cart_id:id,\n                            res_id: this.resturant.res_id,\n                            status: this.status\n                            //total: mi.item_price\n                          });\n                          db.collection('cart').doc(id).collection('items').doc(mi.item_id).set({\n                            item_name: mi.item_name,\n                            item_price: mi.item_price,\n                            item_description: mi.item_description,\n                            item_id: mi.item_id,\n                            item_qty: 1\n                          });\n                          const toast = await this.toast.create({\n                            message: 'Item added to new cart',\n                            duration: 1000,\n                            position: 'top'\n                          });\n                          return await toast.present();\n                        }\n                        catch{\n                          console.log(\"error adding\")\n                        }\n                    }\n            });\n        \n       }\n\n}\n"],"sourceRoot":""}